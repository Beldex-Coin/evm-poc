import base64
import os
import pkg_resources
import unittest

import asyncio
import aiounittest

#from .test_data import XmrTestData
from beldex_serialize import bdxserialize as x
from beldex_serialize import bdxtypes as bdx
from beldex_serialize.helper.msgdecoder import *
#from ..core.readwriter import MemoryReaderWriter

array = [1,45,148,90,51,176,147,127,197,208,50,185,68,221,221,69,240,117,6,189,199,135,237,61,207,101,249,136,229,26,105,228,137,2,9,1,236,217,58,38,111,129,204,142,66,1,3,12,67,111,110,116,114,97,99,116,78,97,109,101,136,146,218,171,42,42,244,64,182,76,234,102,188,66,235,233,61,232,255,159,10,9,245,155,239,217,94,27,186,157,81,234,162,208,0,9,252,235,39,224,29,134,164,137,102,27,82,97,86,117,45,203,77,253,81,141,204,170,84,205,62,70,251,172,14,67,111,110,116,114,97,99,116,77,101,116,104,111,100,16,67,111,110,116,114,97,99,116,65,114,103,117,109,101,110,116,0,228,11,84,2,0,0,0]
array = [1,45,148,90,51,176,147,127,197,208,50,185,68,221,221,69,240,117,6,189,199,135,237,61,207,101,249,136,229,26,105,228,137,2,9,1,236,217,58,38,111,129,204,142,66,1,3,12,67,111,110,116,114,97,99,116,78,97,109,101,136,146,218,171,42,42,244,64,182,76,234,102,188,66,235,233,61,232,255,159,10,9,245,155,239,217,94,27,186,157,81,234,162,208,0,9,252,235,39,224,29,134,164,137,102,27,82,97,86,117,45,203,77,253,81,141,204,170,84,205,62,70,251,172,14,67,111,110,116,114,97,99,116,77,101,116,104,111,100,16,67,111,110,116,114,97,99,116,65,114,103,117,109,101,110,116,0,228,11,84,2,0,0,0]

#array = [1,187,167,21,70,192,253,32,230,81,247,188,158,135,128,41,30,137,244,255,159,136,224,165,166,198,117,84,0,109,32,42,89,2,9,1,64,88,159,242,100,45,58,220,66,0,3,7,67,114,101,97,116,101,49,193,183,223,79,112,121,21,206,112,81,31,227,106,85,13,85,128,240,244,82,236,221,125,151,128,103,242,45,233,196,47,222,23,49,33,143,24,234,2,176,165,79,216,165,188,61,60,203,38,170,30,203,71,173,235,34,29,224,121,30,6,238,126,128,159,216,235,49,55,179,118,87,242,143,129,247,171,106,99,95,128,227,2,188,13,11,58,70,32,133,103,216,215,123,246,231,79,140,104,179,68,175,174,130,246,65,133,20,244,0,112,10,82,184,179,56,147,202,217,152,86,82,24,219,175,228,77,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,83,111,117,114,99,101,50,0,66,220,6,3,0,0,0]
#print(''.join('{:02x}'.format(x) for x in array))
bdx_hex = b'04020000000202000a018a0230029b01d60111380d10c252fedeb3019c9063ae1d685f23eba64453af12812ccaa90c5ac6232ab6e65802000a3360d6013f13434f1c23bc019f95323cade606a157608b6d9f77c6d2fb0c2cd5123fa1184ef5bb9b7cb05d5302000291c22fc5d9a3d67a8f6df181b37d6aadea89a8eb62060a7c7fe0d6c3a4722f6a0002116eb2e4c26fdc0ffb05c8b7eb98ecf9b58ba192d79a346c214ea8d61e4ffe792c0116b91bc5bf5a5e7ae150847453f9a2a27e013d0335daa6d2fac90c1814b6df8d020901e3b145b4acd13e770005caa15823989d1c15c6359130f77b499172c4c881e49a724aa30d8befecf95dce1f8f249da847850cf351f2fc5f844c56ad74bf3ee9e04658ddc36003f8634cf1f5babfb78d18781e51b603a17b74a113c9a2a201ca46044d87d715a2c6e78ca518b7598f83a4f733684cc0d23f5b7152f6bd1e4841c50a8abbbf8e33f821e74b87f8b5af75f15e7eb759ab0e5abd3ff5e80f5b24448ee50ed5d8d3b2c42d0b888e1855195ccf2e4a4b56812b6d33d3f586bf4dae4b7d3091d0492e977672bb03f6fff6fc735e776d1bf62b13f9e64e3523020d4c2d1782f6e01523d50d81b2b8d97e2a4256297703b5b5f02cef4e6ff0d7b7620e4be9de7a4570134f87c304b45ba089d9aee431ca0e7cfcaa13214829b843df00073db7be19e33406bf48f214776367fe9f4751b659e947a16fc3d08f0b967775a1edc67d02221dd93779f9b660df75631c744b936c4bb53dd6133aa95afb34fc4e41e9d992dfbd98bd01f8f99d84a3ab99b56fbc714d94fb51680b129c7d8748ddde6a999e66ecfe9f41bc3235f0ff57422249552fd749de89a5bb4f6135c30b4ca04b3893811753dc2d21f963fbe8e0b8cdf94546e6caaacd92062891e08c7f4b9375298ed92446907d42b580917158ce5ad98fc460fe9e502d0c7a95ccc3425540da5bb2e6991fc30f302657ff22b7b467c061dfa2fcf5691c1f2f5519a1b66c07074a2d1af206d7e4681eaf0dc5236d8581864a71fee9369c54ee65f38c645cf8d8fe0f717c930f458a27831f1e723bff936eb4a1744842ba61c847976f4754408bb157d25472972c856053d560fecd990778f777cab8774bdc82d9e14c0e0830ac98203f8f569cfbcfdf2400e9d48245f6e3e8b0a92d9d5737361f8c17ccc4c98eec900470336c0e5d573542411946f509986a57853524aee5f5e866e33ed5c7a668e1d61e62f990177a34b0e65245c20a511f985adfdb843eeeef2185c138671e9f04d7ce840d71e628d640db6bb6671025f47881fe2828b6a8a944891f92ef6311f63f662690aaad5558787c1f439ea28e86732a671cd14067c6292716be0d40bdf0a2087e5fa0cce0735148ab2ca66acc5ea31f205894f8b5338684e1c20c091946a28292e84105fc9e08a27d970a43cb43bc20a56b98c45c44d1393c85049c2a313a3a026eceabedd05ad3e18a7dcda266e32f2c3a4d3406d0e9b6a5c20f689cab59fbc09701e05d21ccb17544bd47abacd49910d5ead3bf4e839c01d80f9f8810f566ed903165dc2b14b45482ca10801058ecec12c40459381cb428f00475aab45d101d3a76c8a3868c5e9a51ec747bbdf790ce1205ef662edb14f20c04b738ef3084a6935b0947067329f25f5adf07ceaf8d1e62884d574bdfc264e20f762b50ccb524d711f6068a82ce4f75fc49c437b7a288993f79a39890a88c4001c7fbd2aadb30147a4c330f7b458a5fd90e9108b5e09a3728a3befe5b61e2fa000b7217bd5ea0566fe9bf06292ce28294e9023fc3b31df4b1a262faddfd54120c045672fc07b2031ad4af9444924c7a3aa0c5036d9fe795d728162ecdd899eb0717afe511d1a75a95f0f33146099f0299763265dc0c7e98a9b528b92e669258064e84e289962c4a697599cd743d4e53ecc32631a276b4586fc6a51b9c87f47f08d0f8e64ab5ada442e65c9665cbc5dff95ba67a7d07355d62305e69bd492ca41708893fa20c307af51e444c8dfd8dff36462564db57533fd6f0c119725589a9006543b5e7467d2c41c77fafa92b1ea2870171833fcae4029e3af8e865d95f4600904aea7892e58eeee06d54a40e21a0f8c8738a36b69dde7d13a133f3ad98ee09de57a75802093fee1841f279a45238fc1b34c0b1a69bc6236646ad2105176d0094ccad53a717248d691b9eccec8374b7f2c38add142e139496d321c2cc9f5303f146790992ad3ab4933fed358898544a3cfcf63ce49f5ea9a672123524ba9a03fd0b334a539fce2ca1c80e829a96a082124f762fd3416fa004cc17ebe8e2520f10750ca3a55387e16ec2fe7ba44a6b2e1bd06d42c1af28ea342ddc6ef5fb3009964bbe015276b47f1632fe85044be620ff3a6fb74867c75b176df969f1e16e0bd383c646059a535032baa909cbaf7abb28d000f300ccbd803050761a8af705016da58508fd5f638cb2fc3066db33d2da56aa66e5eae1c9b6d8b5a23180d3d50279414f447c6cea8237ec3e76f17d0bf25be9c5a08a372858049a5a495af672aef3ae458daef329f245de4a399f84da1bf13b68e92959f8006899c9495c71351105673c93cbdbf35f18c67b12509cf78766e6af15ddd2e4d0cffc5b4ea8da9816'
bdx_contract= b'040100000202000a1097eb01c041b533f01751dd1386048206063f083c61e99ec74c99ac497e1ea9e89073a7e0cb60df950f23694259ab5dd9bd02000a02b0a6028d4aea029a0cd7038806bd0957ef013b53833cefb61dcc84e4499578c9862809f1f60422c832c6e9217e2fb9ef45f1010002a2f8f83a7a6c41f29e969e1e050e5e74b9582ed2c306cd85b83b47ba8bd195f25a01bb4cb1d44bc4a33af91797584edc4194d3d136732b1915ecb4cf04c3b102cd6b02090127e090552d6fad6742000f6d794669727374436f6e74726163740a48656c6c6f5730726c6410270000000000007910fd117e030000000505a8b5daf637dc5c51a1cdee4c8a7ff5f7634fe7744efeb289569152de876109d1b341d0e3b9fbf2cd9b9589234601ef1c489fd14614ec67312c2be3932b16d12329b31d942fc43d377ce4bff0243e917547da89793bd069419b33ede0eb3d6e051627883a5bb038f4bded3231b0af63c02b6e64cda31efb9507c3f15da6c5dfcbab7eb383b5776133bdd062055ac6ecab0e79dceff38ac3946bd8a721a401da76c115ddd8db205e25df8b846737c629c2383a82f350d9943e5d7e2322acaddf6df2a3d3396414ef7011f99e4d80017bcca4daa13ac25a70818079074675ab2b9f2d5ec00b1dd40837be4954585206061abaf2b50a5e360e3f6384ca0bf3614cc48d290235699e8eed5153efe2eda947d02155abc0fc35c0b64b9160fca5df428c91f99017878a17b53e8961f1bc801336b2ea40114006727bfa8f7b9d2117a551425ef9c73efd22206e4f8404689a74b4ff02a4bffba4a4df103e60c6f267169bcebbc43e9250bf126828b58de0ba8f9b8ba7423510d0f5a46e66224ef8681aca8cb8f13b83a3e2e6594c5c3162e358690836dcde105b97a4215a1bb2896ad342bf19948ab92383c5c3d68245a1b0cd06921c4c5b577417722a9784db9bc2304185bad9c694b01f8cb2019269faad62c65ffd653249e608f58be7ffd01a827140bd2e67a285e2c9b329adb96f7c473b27e8369e1911e7b8a7df3648736d65ddc78a2ec116d743047df47551572f66de2799cfdba13f547470ffafb45462f7b7a96b5faf597c09ac47808f7e054aa7336a49ecc8eda225f347792ee1f2e491e61cd5803edffcd472637eab6e1f8e104af38ed8dbdfc62667e1405b08a3b3e71783d115874e37b28597fb31deaad9f7f2f7fd31121331e12f8a4ebe6fe64acb4911b1f43e68ffe75ad7cb878f0c9678820440c03818ee8d19777835a2528cd33c9423ea59a0d9f9c28f024e60dbbcdc70032528d2eb0bb6c599cb89c84309f1605f91ff3c1f089e2e626cf4b49cb71d94064c463fb00362269550202f61bf894a3a8bd30d7335f3271a3c90b619ce409106b91c0bf741f713956e559a66a5afa597a2a23412a35efa4fce77d5eae4b0070476d94f9a88645d453db0fab7118a8ea0b8c6ab07d46c00436febb061bc09f104fe600edacb7f408ebbae896f974071b4a4e41159e0ce12146e3babfa786f020784355370873c2bc8d8856150fb3ff6a2cb84625820cb1c3a71d68b0bcb97ca0b53dcd7b9c6eb5b2f12b0178a02dc6ae7eb4b754c5db954f75514a7655bd64e069362179c052414dbe90e2d544c2404cc91a10cdf79d00964c50dcd8dfde04b0818a9226edbda9c0c78eec98f1ce41eb14e3b928241c839bca013c90852c0c20a2992af5d486e5dfb8af7d3d180adf404d8d6922fa1a2813d03aacbada6158906cd67c0d9177d44ed48694c8750f5acf3a5126418fd48a129deca9148c3a66808f2bba082646c97be3fd4d2371b4802a6408c0b6c71b28650471d11fa3ff82501afb4af6c5d98a8a088d0a885ae96ff8261562b9bea6d31a4653c7da62d3567c24c99ced378a34abb746196abb2fc17fb432f6edfeeb5c1ae527dcfabb9595e0ccaabf717342dc25840e33051132a2539a8b34b5bd3c22a8418dcab2b1857d60487a4367edccc3aff84b5d1b40dbe02dd7fb2f6658b01fe11880edeecae21160c18301c96f3639f138027e9e77e0eae409a3d11ec286e9cd979ca89f0491487013c3358d9cabdf90105ebeee18f5927e88da6dfd3daecc5089c22eb25c2d3d10d97a4d74b46de06b0112585caf88fb25e94c521ab0d35a01408f248ccc38ab8066c13f6be09d14a46bb2574e1c5684a23f9068de4a5c83900af582b034ccea6079cfad6f3afcb6ccf50f4f4a7c6981fb396cda8ee71e61adfe6ccac6a54d56705826b728f8db7cfad0bc2b52a0e2d01f9432a993f192ceec1bc6cc6111966f10f0985656324b819f6e9af4ab3b7e23427f4748b8e25c6e05fecda30e8c2df700de20011b687e17bcf9aaf9aa9bab355a26b64bf85bb924011bc2a7080b441f00cb7b0e9410b17c853bded7a6adf88cb7635c15f97f5847f00b30f8a6d1ab3c755abefbee2a616b39f66224ca4da5b021baf7d0f75bf2e28e0ad06db22b6d2ef405b781b19278b0ce8b3e9bf1e0e0964f90bd6e02997fb10c9bc5a7494962a9536'
bdx_contract= b'040100000202000a1097eb01c041b533f01751dd1386048206063f083c61e99ec74c99ac497e1ea9e89073a7e0cb60df950f23694259ab5dd9bd02000a02b0a6028d4aea029a0cd7038806bd0957ef013b53833cefb61dcc84e4499578c9862809f1f60422c832c6e9217e2fb9ef45f1010002a2f8f83a7a6c41f29e969e1e050e5e74b9582ed2c306cd85b83b47ba8bd195f25a01bb4cb1d44bc4a33af91797584edc4194d3d136732b1915ecb4cf04c3b102cd6b02090127e090552d6fad6742000f6d794669727374436f6e74726163740a48656c6c6f5730726c6410270000000000007910fd117e030000000505a8b5daf637dc5c51a1cdee4c8a7ff5f7634fe7744efeb289569152de876109d1b341d0e3b9fbf2cd9b9589234601ef1c489fd14614ec67312c2be3932b16d12329b31d942fc43d377ce4bff0243e917547da89793bd069419b33ede0eb3d6e051627883a5bb038f4bded3231b0af63c02b6e64cda31efb9507c3f15da6c5dfcbab7eb383b5776133bdd062055ac6ecab0e79dceff38ac3946bd8a721a401da76c115ddd8db205e25df8b846737c629c2383a82f350d9943e5d7e2322acaddf6df2a3d3396414ef7011f99e4d80017bcca4daa13ac25a70818079074675ab2b9f2d5ec00b1dd40837be4954585206061abaf2b50a5e360e3f6384ca0bf3614cc48d290235699e8eed5153efe2eda947d02155abc0fc35c0b64b9160fca5df428c91f99017878a17b53e8961f1bc801336b2ea40114006727bfa8f7b9d2117a551425ef9c73efd22206e4f8404689a74b4ff02a4bffba4a4df103e60c6f267169bcebbc43e9250bf126828b58de0ba8f9b8ba7423510d0f5a46e66224ef8681aca8cb8f13b83a3e2e6594c5c3162e358690836dcde105b97a4215a1bb2896ad342bf19948ab92383c5c3d68245a1b0cd06921c4c5b577417722a9784db9bc2304185bad9c694b01f8cb2019269faad62c65ffd653249e608f58be7ffd01a827140bd2e67a285e2c9b329adb96f7c473b27e8369e1911e7b8a7df3648736d65ddc78a2ec116d743047df47551572f66de2799cfdba13f547470ffafb45462f7b7a96b5faf597c09ac47808f7e054aa7336a49ecc8eda225f347792ee1f2e491e61cd5803edffcd472637eab6e1f8e104af38ed8dbdfc62667e1405b08a3b3e71783d115874e37b28597fb31deaad9f7f2f7fd31121331e12f8a4ebe6fe64acb4911b1f43e68ffe75ad7cb878f0c9678820440c03818ee8d19777835a2528cd33c9423ea59a0d9f9c28f024e60dbbcdc70032528d2eb0bb6c599cb89c84309f1605f91ff3c1f089e2e626cf4b49cb71d94064c463fb00362269550202f61bf894a3a8bd30d7335f3271a3c90b619ce409106b91c0bf741f713956e559a66a5afa597a2a23412a35efa4fce77d5eae4b0070476d94f9a88645d453db0fab7118a8ea0b8c6ab07d46c00436febb061bc09f104fe600edacb7f408ebbae896f974071b4a4e41159e0ce12146e3babfa786f020784355370873c2bc8d8856150fb3ff6a2cb84625820cb1c3a71d68b0bcb97ca0b53dcd7b9c6eb5b2f12b0178a02dc6ae7eb4b754c5db954f75514a7655bd64e069362179c052414dbe90e2d544c2404cc91a10cdf79d00964c50dcd8dfde04b0818a9226edbda9c0c78eec98f1ce41eb14e3b928241c839bca013c90852c0c20a2992af5d486e5dfb8af7d3d180adf404d8d6922fa1a2813d03aacbada6158906cd67c0d9177d44ed48694c8750f5acf3a5126418fd48a129deca9148c3a66808f2bba082646c97be3fd4d2371b4802a6408c0b6c71b28650471d11fa3ff82501afb4af6c5d98a8a088d0a885ae96ff8261562b9bea6d31a4653c7da62d3567c24c99ced378a34abb746196abb2fc17fb432f6edfeeb5c1ae527dcfabb9595e0ccaabf717342dc25840e33051132a2539a8b34b5bd3c22a8418dcab2b1857d60487a4367edccc3aff84b5d1b40dbe02dd7fb2f6658b01fe11880edeecae21160c18301c96f3639f138027e9e77e0eae409a3d11ec286e9cd979ca89f0491487013c3358d9cabdf90105ebeee18f5927e88da6dfd3daecc5089c22eb25c2d3d10d97a4d74b46de06b0112585caf88fb25e94c521ab0d35a01408f248ccc38ab8066c13f6be09d14a46bb2574e1c5684a23f9068de4a5c83900af582b034ccea6079cfad6f3afcb6ccf50f4f4a7c6981fb396cda8ee71e61adfe6ccac6a54d56705826b728f8db7cfad0bc2b52a0e2d01f9432a993f192ceec1bc6cc6111966f10f0985656324b819f6e9af4ab3b7e23427f4748b8e25c6e05fecda30e8c2df700de20011b687e17bcf9aaf9aa9bab355a26b64bf85bb924011bc2a7080b441f00cb7b0e9410b17c853bded7a6adf88cb7635c15f97f5847f00b30f8a6d1ab3c755abefbee2a616b39f66224ca4da5b021baf7d0f75bf2e28e0ad06db22b6d2ef405b781b19278b0ce8b3e9bf1e0e0964f90bd6e02997fb10c9bc5a7494962a9536'
bdx_extra =b'01bb4cb1d44bc4a33af91797584edc4194d3d136732b1915ecb4cf04c3b102cd6b02090127e090552d6fad6742000f6d794669727374436f6e74726163740a48656c6c6f5730726c6410270000000000007910fd117e03000000'
bdx_extra =b'01132bd7fa1eaa832988af382e41291c683616f5bd0c7356509c0356da7f2073b8020901ae8b4a3a7ff884434200064269674f6e65ac02414141414141414141414242424242424242424241414141414141414141424242424242424242424141414141414141414142424242424242424242414141414141414141414242424242424242424241414141414141414141424242424242424242424141414141414141414142424242424242424242414141414141414141414242424242424242424241414141414141414141424242424242424242424141414141414141414142424242424242424242414141414141414141414242424242424242424241414141414141414141424242424242424242424141414141414141414142424242424242424242414141414141414141414242424242424242424243434343434343434343424242424242424242424343434343434343434342424242424242424242b5e60f000000000079b5bc217e03000000'
#bdex_json = '"version":4,"output_unlock_times":[0,0],"unlock_time":0,"vin":[{"key":{"amount":0,"key_offsets":[1,266,48,2,155,214,17,56,13,16],"k_image":"c252fedeb3019c9063ae1d685f23eba64453af12812ccaa90c5ac6232ab6e658"\}\},{"key":{"amount":0,"key_offsets":[51,96,214,63,19,67,79,28,35,188],"k_image":"9f95323cade606a157608b6d9f77c6d2fb0c2cd5123fa1184ef5bb9b7cb05d53"\}\}],"vout":[{"amount":0,"target":{"key":"91c22fc5d9a3d67a8f6df181b37d6aadea89a8eb62060a7c7fe0d6c3a4722f6a"\}\},{"amount":0,"target":{"key":"116eb2e4c26fdc0ffb05c8b7eb98ecf9b58ba192d79a346c214ea8d61e4ffe79"\}\}],"extra":[1,22,185,27,197,191,90,94,122,225,80,132,116,83,249,162,162,126,1,61,3,53,218,166,210,250,201,12,24,20,182,223,141,2,9,1,227,177,69,180,172,209,62,119],"type":0,"rct_signatures":{"type":5,"txnFee":1446090,"ecdhInfo":[{"amount":"23989d1c15c63591"},{"amount":"30f77b499172c4c8"}],"outPk":["81e49a724aa30d8befecf95dce1f8f249da847850cf351f2fc5f844c56ad74bf","3ee9e04658ddc36003f8634cf1f5babfb78d18781e51b603a17b74a113c9a2a2"]},"rctsig_prunable":{"nbp":1,"bp":[{"A":"ca46044d87d715a2c6e78ca518b7598f83a4f733684cc0d23f5b7152f6bd1e48","S":"41c50a8abbbf8e33f821e74b87f8b5af75f15e7eb759ab0e5abd3ff5e80f5b24","T1":"448ee50ed5d8d3b2c42d0b888e1855195ccf2e4a4b56812b6d33d3f586bf4dae","T2":"4b7d3091d0492e977672bb03f6fff6fc735e776d1bf62b13f9e64e3523020d4c","taux":"2d1782f6e01523d50d81b2b8d97e2a4256297703b5b5f02cef4e6ff0d7b7620e","mu":"4be9de7a4570134f87c304b45ba089d9aee431ca0e7cfcaa13214829b843df00","L":["3db7be19e33406bf48f214776367fe9f4751b659e947a16fc3d08f0b967775a1","edc67d02221dd93779f9b660df75631c744b936c4bb53dd6133aa95afb34fc4e","41e9d992dfbd98bd01f8f99d84a3ab99b56fbc714d94fb51680b129c7d8748dd","de6a999e66ecfe9f41bc3235f0ff57422249552fd749de89a5bb4f6135c30b4c","a04b3893811753dc2d21f963fbe8e0b8cdf94546e6caaacd92062891e08c7f4b","9375298ed92446907d42b580917158ce5ad98fc460fe9e502d0c7a95ccc34255","40da5bb2e6991fc30f302657ff22b7b467c061dfa2fcf5691c1f2f5519a1b66c"],"R":["074a2d1af206d7e4681eaf0dc5236d8581864a71fee9369c54ee65f38c645cf8","d8fe0f717c930f458a27831f1e723bff936eb4a1744842ba61c847976f475440","8bb157d25472972c856053d560fecd990778f777cab8774bdc82d9e14c0e0830","ac98203f8f569cfbcfdf2400e9d48245f6e3e8b0a92d9d5737361f8c17ccc4c9","8eec900470336c0e5d573542411946f509986a57853524aee5f5e866e33ed5c7","a668e1d61e62f990177a34b0e65245c20a511f985adfdb843eeeef2185c13867","1e9f04d7ce840d71e628d640db6bb6671025f47881fe2828b6a8a944891f92ef"],"a":"6311f63f662690aaad5558787c1f439ea28e86732a671cd14067c6292716be0d","b":"40bdf0a2087e5fa0cce0735148ab2ca66acc5ea31f205894f8b5338684e1c20c","t":"091946a28292e84105fc9e08a27d970a43cb43bc20a56b98c45c44d1393c8504"}],"CLSAGs":[{"s":["9c2a313a3a026eceabedd05ad3e18a7dcda266e32f2c3a4d3406d0e9b6a5c20f","689cab59fbc09701e05d21ccb17544bd47abacd49910d5ead3bf4e839c01d80f","9f8810f566ed903165dc2b14b45482ca10801058ecec12c40459381cb428f004","75aab45d101d3a76c8a3868c5e9a51ec747bbdf790ce1205ef662edb14f20c04","b738ef3084a6935b0947067329f25f5adf07ceaf8d1e62884d574bdfc264e20f","762b50ccb524d711f6068a82ce4f75fc49c437b7a288993f79a39890a88c4001","c7fbd2aadb30147a4c330f7b458a5fd90e9108b5e09a3728a3befe5b61e2fa00","0b7217bd5ea0566fe9bf06292ce28294e9023fc3b31df4b1a262faddfd54120c","045672fc07b2031ad4af9444924c7a3aa0c5036d9fe795d728162ecdd899eb07","17afe511d1a75a95f0f33146099f0299763265dc0c7e98a9b528b92e66925806"],"c1":"4e84e289962c4a697599cd743d4e53ecc32631a276b4586fc6a51b9c87f47f08","D":"d0f8e64ab5ada442e65c9665cbc5dff95ba67a7d07355d62305e69bd492ca417"},{"s":["08893fa20c307af51e444c8dfd8dff36462564db57533fd6f0c119725589a900","6543b5e7467d2c41c77fafa92b1ea2870171833fcae4029e3af8e865d95f4600","904aea7892e58eeee06d54a40e21a0f8c8738a36b69dde7d13a133f3ad98ee09","de57a75802093fee1841f279a45238fc1b34c0b1a69bc6236646ad2105176d00","94ccad53a717248d691b9eccec8374b7f2c38add142e139496d321c2cc9f5303","f146790992ad3ab4933fed358898544a3cfcf63ce49f5ea9a672123524ba9a03","fd0b334a539fce2ca1c80e829a96a082124f762fd3416fa004cc17ebe8e2520f","10750ca3a55387e16ec2fe7ba44a6b2e1bd06d42c1af28ea342ddc6ef5fb3009","964bbe015276b47f1632fe85044be620ff3a6fb74867c75b176df969f1e16e0b","d383c646059a535032baa909cbaf7abb28d000f300ccbd803050761a8af70501"],"c1":"6da58508fd5f638cb2fc3066db33d2da56aa66e5eae1c9b6d8b5a23180d3d502","D":"79414f447c6cea8237ec3e76f17d0bf25be9c5a08a372858049a5a495af672ae"}],"pseudoOuts":["f3ae458daef329f245de4a399f84da1bf13b68e92959f8006899c9495c713511","05673c93cbdbf35f18c67b12509cf78766e6af15ddd2e4d0cffc5b4ea8da9816"]\}\}'
bdx_contract_new =b'01b8c8d5dde2ec05f67c9094182898feec1ddfb9857252db6a26215001a10d7e770209011b22f5d6221d227d4200030c436f6e74726163744e616d6509fb3285c12eac0a81ba0d7d58f0265d9ec1adc1498f11475a5743390c44015ed86abd986f89dfa4d937c8867a021bb4a4926e160f2d9bce8954743c13e78aeb9fd8eb3137b37657f28f81f7ab6a635f80e302bc0d0b3a46208567d8d77bf6e73b5fbb91626732bbc1454e64af0ffc58771fd8e2f0351231ba4b6edb8c853f0100000000000000000000000000000000000000000000000000000000000000000e436f6e7472616374536f7572636500c817a804000000'
bdx_contract_new =b'01bba71546c0fd20e651f7bc9e8780291e89f4ff9f88e0a5a6c67554006d202a5902090140589ff2642d3adc4200030743726561746531c1b7df4f707915ce70511fe36a550d5580f0f452ecdd7d978067f22de9c42fde1731218f18ea02b0a54fd8a5bc3d3ccb26aa1ecb47adeb221de0791e06ee7e809fd8eb3137b37657f28f81f7ab6a635f80e302bc0d0b3a46208567d8d77bf6e74f8c68b344afae82f6418514f400700a52b8b33893cad998565218dbafe44d01000000000000000000000000000000000000000000000000000000000000000007536f75726365320042dc0603000000'
bdx_contract_method =b'012d945a33b0937fc5d032b944dddd45f07506bdc787ed3dcf65f988e51a69e489020901ecd93a266f81cc8e4201030c436f6e74726163744e616d658892daab2a2af440b64cea66bc42ebe93de8ff9f0a09f59befd95e1bba9d51eaa2d00009fceb27e01d86a489661b526156752dcb4dfd518dccaa54cd3e46fbac0e436f6e74726163744d6574686f6410436f6e7472616374417267756d656e7400e40b5402000000'
bdx_contract = b'018427eda1e94318df6837185f0fc1b3476f39513937d04b88f3363177d40fcf4102090134bd4ddc27f24c7142000a4372656174654e616d650e436f6e7472616374536f757263652c0100000000000079008e765749000000'
bdx_contract_method = array
bdx_contract = b'04020000000202000aedfb0c93059512d1048508ce04b2060437ab01e0a73fbcadc4641b0800a91b450fd1c5fe982bebaef63d619021ca680914770c02000a8be608c91cfbc603e9229607ae0baf06e50b8d14a5054336395fc42d5aaecf046bc3a99ba4a520ebbdc6becb560b94792861cca09cec02000259fe2cc43b3f182ab3b91fbc63c20e35bf56fbc1c88c42b6a0f447ceeb36dbbb0002c28b683dd8e01f7c5c70b461ffa5f6f06c52c2023c0fb30fb5f1854c1e746000ec0101696f3519cc6959eaef19000ecd74899ffe8790a2f0ffb51a8cff146afe4846ac02090134886b6ca6ca72054200030d636f6e74726163747465737434b0674cdde81b84b6a9e2b2bdae62a9b342815e6a9244a3bc788aba210425b675efc1bd6161cdbd7ce5dd764935dabf3dc869c6d6556e53de2644f7ce5731f3a99fd8eb3137b37657f28f81f7ab6a635f80e302bc0d0b3a46208567d8d77bf6e71abab2b31ae5f464e67b392b2605aba547a1dde58fb91ff5a6d76f2a1c557b0b000000000000000000000000000000000000000000000000000000000000000006736f7572636500e876481700000005058ef1da062db92351180007debb263314139dd037429bcc5667c941b233beea398251eddd600609361ea704f4ca5c2c91ef76c5777ff9ee37257ed60a18917be901f337d79f2acb7bb2b96bd0230f319ec65bd01401b6af54d09702e8e00940457a89464be2725c5fdc07f96f2c0d1ea19d6166df7071e40342169609ad1be52f5804e827070e4e3563b927b441ebcca69ed5f9d2024094054b17338279ad499bcb3e4aba64a27781a4826c9ad3c3c1e25c7e6b848c8935cf9345ca2817256f0b100416fbc37c89ee760fa43fbeb1c4d0887b948a6f6eaa17f035f5c6b021e4a5bc77ef8487b1aaad40a3601937713fcaec69fe050cadf62d6acf68589faae45a7a4b17661e2fb7c47faf10c991579dd707396b640907bf87f6329a3afe63c087a9c535040396a5f977817f98d162e7db01be33cd163cd6bfa1300a9b1cddcf41d2204fab13371500d12761bca02bf00900026d08624c2cd4fcb542eab7aeb8703dd8615491c9c88ff352c6f678ed336b2ec01b5ca633c028bc7fe066dc6989af1282d321fc4b6823ac81a227b1070fa14f953a36c27d9ae3b7d9dd5210f70acc6047c60fd286a878b6b5bda801bed33f8b6c484e6b80ec3b590937636dcac5e4a06dc1f35a4088445255ca54969644664a1dc3f00387fc4aad99ec740d31658fd86bdd0bbfc125d11047cb38c3af1a7faa9397be9a2c071ffe16936a232e8df1a65f3b2dd85a1f6db031bc0a9dbabdf03c4651295b483c0cf2e69c43e97c66736a1c262aaec2d1827aba7ad18ce90bb78c1795f376835e777a37f7e90bb8c42b7b6fc139591370382192c513a0483ca155e22c9efb27f97662bef7592de4edfb1036f309b82cc6161d5ee0bbab2f68a93f01f13d1ebb84acdb952c301bc38f1f6545650dd993a28115e05a7235cc936819aedc242fc9365bf3b877939f2508907e2feae6ebb7af022ae429bcceb5314b1eb6de2b7054f2e43144adf5643f80aa5283c6115466687b35930d2862a1c786684c9f2e930dd3fc1ff0603fb699f3517cfa739b40f7840f6ec011eda3487e434ba0019dab690f38cecfe7dd493c960144a6000898aa0a909734496157bea8ad01e838fa36b409bb0396d620cc71510152c5bff352dd198c882005692ad2636e6cd13cf091880b1b19c26961e782c7ba6fc1793a0b52bb620cf1992bc78b3fb011525e89ad0509317cd0414a5c0bedd405d9b451a661c821759e65665c197429bac7b746f0f605972fdac370d1ce1c6de1b69ab1ee7be42233c7bc3ebc0b55788cc8803aaf6f01585d43d0ba85d7a3d5bcfa3ef5c23672c0e56b29cb51ef7a2ad09b4d1bff75046e0240a6c00851ce237101b44434c174e4114bffa15a4e3eb219e2d3e782e30b092d4b309049db3202386effd251c0e5687d9132bcedf6819dce5ca10dbfb20fc3d3456bb0069e9a0498ef41b2f4954d32761ec1db82d6eeff4986d1e9a8e3033e94d59ca1af23ee033f349e58e6b57e9f78c07d39850dca872093e242d44c01b9eaffc396ad08a0fa7dd07977b77228f171db4b2dcc137437c8e0afc124bd0e3c91c52d7e0e7ffc3acbce96d8581584a506eb999f129166e8e4652b1601ad0ae501e87ac6d5c52ae6e7396cb04280cf85396bdb36b62e7f44e390c10ca8670801564dfdc24ba48dbecba76f20e04ff4092c18706b7730c278ad0885e7c7398cb47302ab1ef45736768140cfc304cc1256152e2c80237b786b5687e01f543d013016bb1ee9a38df53a3c49768cbb47589aa02a73c6195dceab1bad58aabaac0db4b9c35a112a57d8f6e707af674754bfd51e4a900da408845729f620ed435b0ed16af9f22145ddee0e016b588968ffb614b453ac647df3cdecf823f4855f8005d04116d0d0756e8753e44542b6fc8963f36efd11bf0497e600d9fd83e0508e0460db0aeafe371ce21dc0ef94a2157a98f5dedf61a24cafd8ccb8f9d5d5fb8a039920e7ce1d3bcaa963a1c74fdeca9ca850ab55fa332eaa9ea563cbe1a9609d0a571225d1d7afaaf5dc00a4163363e92a94fb81ca47f8cb3b39236049c2f57e0f8200621073a1f0c8bf6b4491da62715f4137adfeed4feb3888578b5e86539d04c4ee5f08323680baedf725ff1690b8e7719e557f018fb0a0c7fa88c61b1cf909e5604066b07e110cb0287e16e7e6a26304a71abb2f4ad6e3eae534003afb290c447dc130512d4f36ffc3d7a4cbdd61bc6b58dc70cc7930cce7dfa78548f8051711f4ed14ba729fca3306a696bbbb21dce078e8f4a615cbfa16207211d92b6ff929053e82b0ae7b5968f9fd3e3190c7b955fcd15318d570d5a43e1510e7798195'
tsx_bin = base64.b16decode(bdx_contract, True)
reader = x.MemoryReaderWriter(bytearray(tsx_bin))
ar1 = x.Archive(reader, False, bdx.hf_versions(18))


test_deser = asyncio.run(ar1.message(None, bdx.TransactionPrefix))#, bdx.TransactionPrefix)) TxExtraTagContractSource
print(test_deser.extra)
test_deser2 = decodePrefix(''.join('{:02x}'.format(x) for x in test_deser.extra))
#contract = decodeContract(bytearray(test_deser.extra))
contract= decodeContract(b'01bba71546c0fd20e651f7bc9e8780291e89f4ff9f88e0a5a6c67554006d202a5902090140589ff2642d3adc4200030743726561746531c1b7df4f707915ce70511fe36a550d5580f0f452ecdd7d978067f22de9c42fde1731218f18ea02b0a54fd8a5bc3d3ccb26aa1ecb47adeb221de0791e06ee7e809fd8eb3137b37657f28f81f7ab6a635f80e302bc0d0b3a46208567d8d77bf6e74f8c68b344afae82f6418514f400700a52b8b33893cad998565218dbafe44d01000000000000000000414141410000000000000000000000000000000000000007536f75726365320042dc0603000000')
#contract= decodeContract(bytearray(base64.b16decode(bdx_contract_method, True)))print(''.join(chr(x) for x in contract.contract.contract_name))
if contract.contract.contract_type==1:
    print(''.join(chr(x) for x in contract.contract.method))
    print(''.join(chr(x) for x in contract.contract.args))
if contract.contract.contract_type==0:
    print(''.join('{:02x}'.format(x) for x in contract.contract.owner_pubkey))
    print(''.join(chr(x) for x in contract.contract.contract_source))

print(contract.contract.amount)
#print(''.join(chr(x) for x in contract.contract.contract_source))
#9fd8eb3137b37657f28f81f7ab6a635f80e302bc0d0b3a46208567d8d77bf6e7


print("wait")
